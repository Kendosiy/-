<!DOCTYPE html>
<html>
	<head>
		<link href="../../style.css" rel="stylesheet">
	</head>
	<body>
		<header>
			<div>
				<h1>Учебный портал</h1>
			</div>
		</header>
		<nav>
			<ul class="main_menu">
				<li><a href="../../index.html">Главная</a></li>
				<li>
					<p>Справочные материалы</p>
					<ul class="submenu">
						<li>HTML & CSS</li>
						<li><a href="../../delphi-lab-teor.html">Delphi</a></li>
					</ul>
				</li>
				<li>
					<p>Учебные материалы</p>
					<ul class="submenu">
						<li><a href="../../delphi-lab-prac.html">Лабораторные работы Delphi</a></li>
					</ul>
				</li>
			</ul>
		</nav>
		<main>
			<aside id="sidebar">
				<h2>Быстрая навигация</h2>
				<ol>
					<li><a href="#1">Типы окна сообщения</a></li>
					<li><a href="#2">Кнопки окна сообщения</a></li>
					<li><a href="#3">Тип сообщения</a></li>
				</ol>
			</aside>
			<article class="tema">
				<h2>Функции вызова диалоговых окон с сообщениями</h2>

				<p>Сообщения присутствуют повсюду: когда вы пытаетесь
				закрыть не сохраненный проект, при появлении ошибки, когда программа сообщает о
				некотором событии.<br>
				<br>
				Можно разделить все программные сообщения на: информационные сообщения
				(Загрузка данных с дискеты завершена) , предупреждающие сообщения
				(Файл модифицирован. Сохранить?), сообщения об ошибке (Файл
				данных программы не найден. Требуется переустановка программы). <br>
				<br>
				Ради экономии времени, вы можете всегда, из любого места программы показать
				пользователю, к примеру, следующее сообщение:<br>
				<img width=105 height=103
				src="_5_Сообщения.files/image001.gif">
				<br>
				В чем же заключается экономия времени и экономия текста кода программы. Такое
				сообщение выводится на экран одной строчкой: ShowMessage('Привет!');<br>
				<br>
				Тип данных в скобках - <b>String</b>.<br>
				На этой команде работа процедуры (не всей программы!) приостанавливается. Пока
				пользователь не нажмет на кнопку Ok, работа с приложением становится
				невозможным, т.е. нельзя добраться до окна, расположенного позади.
				Т.е. это сообщение открывается модально.<br>
				<br>
				Заголовок окна содержит в себе текст,
				который отображен на панели задач. По умолчанию имеет название запускаемого EXE
				файла. <br>
				Изменить название запущенной программы в панели задач можно в любом месте
				программы с помощью команды:<br>
				<br>
				Application.Title:='Название программы';<br>
				<br>
				К примеру, вы обрабатываете довольно объемный размер данных (чтение файлов), и
				хотите показывать процент выполнения задания прямо в панели задач (как это
				сделано в программе DrWeb). Ведь пользователь не всегда сможет смотреть на ваш
				10-минутный процесс обработки данных, а скорее всего переключится на другую,
				менее трудоемкую операцию (карточный пасьянс), постоянно следя за процессом
				обработки на панели задач.<br>
				<br>
				Изначально, еще до запуска программы на выполнение, на этапе разработки, вы
				можете это задать название программы в панели задач с помощью главного меню
				delphi Project, дальше пункт Options..., в открывшемся
				окне на вкладке <b>Application</b> указать в поле <b>Title</b> необходимую
				строку. Эта строка и будет отображена в панели задач. При этом следует помнить,
				что слишком длинная фраза в кнопке на панели задач полностью не будет показана.
				При этом она будет обрезана троеточием, а для того, чтобы узнать полное
				название запущенной программы, нужно будет подвести мышку (всплывающая подсказка
				Hint вам покажет полное название).<br>
				<br>
				Недостатком команды вывода строки <b>ShowMessage</b> является то, что нельзя
				отдельно от названия программы в панели задач, менять заголовок окошка, нельзя
				получить иконку в окошке, нельзя отображать другие кнопки.<br>

				В Delphi есть функция отображения окна сообщения. Звучит оно так:<br>
				<br>
				MessageDLG(ТЕКСТ_СООБЩЕНИЯ,ТИП_СООБЩЕНИЯ,КНОПКИ,ИНДЕКС_ПОМОЩИ);<br>
				<br>
				Поскольку нашим программам мы пока не
				пишем дополнительно файлов справки, поэтому ИНДЕКС_ПОМОЩИ у нас всегда будет
				нулевым. Для информации скажу, что если у нас таковой файл имеется, то можно в
				таком сообщении сделать кнопку Help. Если пользователь озадачен
				вопросом или сообщением, то может, не закрывая этого окна, узнать подробнее о
				дальнейших этапах работы при выборе того или иного пункта.<br>
				ТЕКСТ_СООБЩЕНИЯ - строковая величина. Как в предыдущей команде, сообщение
				показывается внутри окна.<br>
				<a name="1"></a>
				<br>
				ТИП_СООБЩЕНИЯ - может принимать несколько значений. От этих значений зависит
				содержимое заголовка и иконка в левом верхнем углу окна.</p>
				
				<table>
				 <tr>
				  <td>
				  <p><b>Тип сообщения</b></p>
				  </td>
				  <td>
				  <p><b>Описание</b></p>
				  </td>
				  <td>
				  <p><b>Вид</b><b></p>
				  </td>
				 </tr>
				 <tr>
				  <td>
				  <p>mtWarning</p>
				  </td>
				  <td>
				  <p>Можно использовать в
				  предупреждающих сообщениях. Например, Вы действительно желаете удалить
				  все данные с диска С:</p>
				  </td>
				  <td>
				  <p><img width=128 height=122
				  src="_5_Сообщения.files/image002.gif" >
				  </td>
				 </tr>
				 <tr>
				  <td>
				  <p>
				  </td>
				  <td>
				  <p>Обычное окошко вывода сообщения
				  об ошибки. Всем знаком его вид т.к. это наиболее частое окно в windows :) </p>
				  </td>
				  <td>
				  <p><img width=110 height=122
				  src="_5_Сообщения.files/image003.gif" >
				  </td>
				 </tr>
				 <tr>
				  <td>
				  <p>mtInformation</p>
				  </td>
				  <td>
				  <p>Какая-нибудь информация.
				  Например, Не найден файл настройки, создается заново</p>
				  </td>
				  <td>
				  <p><img width=140 height=122
				  src="_5_Сообщения.files/image004.gif" >
				  </td>
				 </tr>
				 <tr>
				  <td>
				  <p>mtConfirmation</p>
				  </td>
				  <td>
				  <p>Это запрос. Запрос на сохранение
				  перед выходом, спрашивает перед удалением параметра, и т.п. На ваш
				  собственный вкус</p>
				  </td>
				  <td>
				  <p><img width=146 height=122
				  src="_5_Сообщения.files/image005.gif" >
				  </td>
				 </tr>
				 <tr>
				  <td>
				  <p>mtCustom</p>
				  </td>
				  <td>
				  <p>Это сообщение полностью
				  аналогично ShowMessage</p>
				  </td>
				  <td>
				  <p><img width=105 height=103
				  src="_5_Сообщения.files/image006.gif" >
				  </td>
				 </tr>
				</table>
				<a name="2"></a>
				<br>
				<p><b>Кнопки</b> - содержит в себе массив кнопок,
				которые следует показывать в сообщении.<br>
				Даю перечень кнопок.<br>
				<br>
				* mbYes<br>
				* mbNo<br>
				* mbOK<br>
				* mbCancel<br>
				* mbHelp<br>
				* mbAbort<br>
				* mbRetry<br>
				* mbIgnore<br>
				* mbAll<br>
				<br>
				Рассказывать про каждую кнопку не буду, т.к. все равно ее название нельзя
				сменить. А если вам англоязычный термин непонятен, то тогда какой смысл ее
				применять :).<br>
				Массив кнопок задается в квадратных кавычках []. Например, нам надо задать три
				кнопки <b>Yes</b>, <b>No</b>, <b>Cancel</b>. Это делается так <b>[mbYes,mbNo,mbCancel]</b>.<br>
				Поскольку кнопки в сообщении могут быть разные, то MessageDLG является
				функцией. Она возвращает результат нажатой кнопки.<br>
				Соответственно указанным выше кнопкам результат может принимать следующие
				значения<br>
				<br>
				* mrNone - окно сообщения закрыто не с помощью кнопки (Alt+F4 или кнопкой
				закрыть)<br>
				* mrAbort<br>
				* mrYes<br>
				* mrOk<br>
				* mrRetry<br>
				* mrNo<br>
				* mrCancel<br>
				* mrIgnore<br>
				* mrAll<br>
				<br>
				Рассмотрим пример. Нам надо спросить у пользователя о дальнейших действиях
				перед выходом из программы.<br>
				<br>
				<b>1</b>. Сохранить файл.<br>
				<b>2</b>. Не сохранять файл.<br>
				<b>3</b>. Продолжить редактирование.<br>
				<br>
				<b></b> R:Word; //
				переменная, в которой хранится результат<br>
				...<br>
				R:=MessageDLG('Сохранить файл перед выходом?',mtConfirmation,[mbYes,mbNo,mbCancel],0);<br>
				<b>if</b> R=mrYes <b>then</b> // если нажата кнопка Yes<br>
				<b>begin</b><br>
				// сохраняем файл и завершаем программу<br>
				<b>end</b>;<br>
				<b>if</b> R=mrNo <b>then</b> // если нажата кнопка No<br>
				<b>begin</b><br>
				// завершаем работу программы без сохранения<br>
				<b>end</b>;<br>
				<b>if</b> R=mrCancel <b>then</b> // если нажата кнопка Cancel<br>
				<b>begin</b><br>
				// продолжаем работу без сохранения<br>
				<b>end</b>;<br>
				<br>
				Мы рассмотрели команду <b>MessageDLG</b>. Это очень гибкая команда, есть много
				достоинств, но есть один существенный недостаток - англоязычный интерфейс.<br>
				<br>
				Следующая команда использует системные сообщения пользователю вашей
				операционной системы. Т.е., если у вас установлена, например немецкая версия
				windows, то кнопки будут иметь соответствующие названия на немецком языке.<br>
				Вот эта команда:<br>

				Первый параметр - указатель на владельца окна сообщения. Этот параметр вам пока
				ничего не говорит, устанавливайте его в Handle (это ссылка на окно, откуда это
				сообщение вызывается).<br>
				ТЕКСТ_СООБЩЕНИЯ и ЗАГОЛОВОК_ОКНА - имеют тип PChar, поэтому, во
				избежание недоразумений и появления неизвестного рода ошибок, выдаваемых
				компилятором, меняйте тип String в PChar на ходу. Например:<br>
				<br>
				MessageBox(Handle,PChar('ТЕКСТ_СООБЩЕНИЯ'),PChar('ЗАГОЛОВОК_ОКНА'),...<br>
				<br>
				Это был перевод из одного типа строковой величины в другой тип.<br>
				<a name="3"></a>
				<br>
				Теперь поговорим о немного сложном параметре ТИП_СООБЩЕНИЯ. Он включает в себя
				иконку и кнопки.<br>
				<br>
				Кнопки:<br>
				* <b>MB_ABORTRETRYIGNORE</b> - кнопки Прервать,
				Повторить, Пропустить.<br>
				* <b>MB_OK</b> - кнопка Ok.<br>
				* <b>MB_OKCANCEL</b> - кнопки Ok, Отмена.<br>
				* <b>MB_RETRYCANCEL</b> - кнопки Повторить и Отмена.<br>
				* <b>MB_YESNO</b> - две кнопки Да и Нет.<br>
				* <b>MB_YESNOCANCEL</b> - кнопки Да, Нет,
				Отмена.<br>
				<br>
				Для того, чтобы отобразить иконку, нужно указать:<br>
				* <b>MB_ICONEXCLAMATION</b><br>
				* <b>MB_ICONWARNING</b><br>
				* <b>MB_ICONINFORMATION</b><br>
				* <b>MB_ICONASTERISK</b><br>
				* <b>MB_ICONQUESTION</b> <br>
				* <b>MB_ICONSTOP</b><br>
				* <b>MB_ICONERROR</b><br>
				* <b>MB_ICONHAND</b><br>
				Если у вас в сообщении несколько кнопок, а по умолчанию нужно выбрать
				определенную, то такая кнопка задается:<br>
				<b><br>
				MB_DEFBUTTON1</b> - где последняя цифра указывает номер кнопки, выбранной по
				умолчанию. Это свойство может быть полезным, например, чтобы обезопасить данные
				от случайного уничтожения. Удалить файл?. Две кнопки -
				Да, Нет. По умолчанию мы программно выбираем вторую
				кнопку. Если пользователь сразу нажал на Enter, не осознавая своего поступка,
				можно сказать по привычке, то ничего страшного не произойдет.<br>
				<br>
				Как же указать параметры иконки, кнопок, кнопки по умолчанию в одном параметре <b>ТИП_СООБЩЕНИЯ</b>.
				Очень просто. Простым знаком +<br>
				Например:<br>
				<br>
				MessageBox(Handle,PChar('Выйти
				из программы?'),PChar('Мое
				сообщение'),MB_ICONINFORMATION+MB_OKCANCEL+MB_DEFBUTTON2);<br>
				<br>
				<img width=191 height=119
				src="_5_Сообщения.files/image007.gif">
				<br>
				Выглядит это в программе так, как показано на рисунке: <br>
				<br>
				Итак, MessageBox можно считать идеальной командой вывода сообщения
				пользователю, которая будет совместима со всеми языковыми версиями windows.<br>
				<br>
				Контроль нажатия на кнопку в MessageBox мы осуществляем аналогично MessageDLG,
				только возвращаемая величина может принимать следующие значение (соответственно
				нажатой кнопке):<br>
				<br>
				* IDABORT<br>
				* IDCANCEL<br>
				* IDIGNORE<br>
				* IDNO<br>
				* IDOK<br>
				* IDRETRY<br>
				* IDYES</p>
			</article>	
		</main>
		<footer class="footer">
			<div></div>
		</footer>
		<script src="../../scripts.js"></script>
	</body>
</html>