<!DOCTYPE html>
<html>
	<head>
		<link href="../../style.css" rel="stylesheet">
	</head>
	<body>
		<header>
			<div>
				<h1>Учебный портал</h1>
			</div>
		</header>
		<nav>
			<ul class="main_menu">
				<li><a href="../../index.html">Главная</a></li>
				<li>
					<p>Справочные материалы</p>
					<ul class="submenu">
						<li>HTML & CSS</li>
						<li><a href="../../delphi-lab-teor.html">Delphi</a></li>
					</ul>
				</li>
				<li>
					<p>Учебные материалы</p>
					<ul class="submenu">
						<li><a href="../../delphi-lab-prac.html">Лабораторные работы Delphi</a></li>
					</ul>
				</li>
			</ul>
		</nav>
		<main>
			<aside id="sidebar">
				<h2>Быстрая навигация</h2>
				<ol>
					<li><a href="#1">Стандартные классы исключений</a></li>
				</ol>
			</aside>
			<article class="tema">
				<h2>
					Обработка исключений
				</h2>
				<p>
					Исключения (исключительные ситуации) возникают при некорректных действиях
					программы во время выполнения. Например: деление на ноль, попытка открыть
					несуществующий файл, выход за пределы выделенной динамической памяти. Это
					может быть ошибка программиста, не предусмотревшего возможные последствия
					работы некоторых операторов. Причина может заключаться в недостаточно
					четкой постановке задачи, т.е. заказчик не указал возможные ограничения на
					значение параметров. Очень часто виновником исключительных ситуаций
					становятся пользователи программного продукта, совершающие неверные
					действия при работе с программой.
				</p>
				<p>
					В любом случае при возникновении ошибки происходит аварийное завершение
					работы с программой.
				</p>
				<p>
					Чтобы этого избежать и повысить надежность программы, следует создавать
					обработчики исключений, которые защитят программу от краха и выполнят
					корректный выход из ситуации.
				</p>
				<p>
					Для обработки исключений в Delphi предусмотрены 2 механизма защищенного блока:
				</p>
				<code>
					<pre>
1).	<strong>Try</strong> 				2) <strong>Try</strong>
	&lt;операторы&gt; 			&lt;операторы&gt;
	<strong>except </strong>				<strong>finally</strong>
	&lt;обработчики исключений&gt;	&lt;операторы&gt;
	<strong>else</strong>				<strong>end;</strong>
	&lt;операторы&gt;
	<strong>end;</strong>
					</pre>
				</code>
				<p>
					Защищенный блок начинается зарезервированным словом <strong>try</strong> (попытаться
					выполнить).
				</p>
				<p>
					В первом блоке сначала выполняются операторы из раздела <strong>try</strong>…<strong>except</strong>. Сюда
					помещаются операторы, в которых может возникнуть ошибка выполнения. Если
					исключительной ситуации не возникло, то управление получает оператор,
					стоящий после слова <strong>end</strong>. Если исключение возникло, то управление получает
					обработчик в секции <strong>except</strong>. Среди нескольких обработчиков в этой секции
					программа ищет подходящий, а если не находит, то выполняются операторы,
					стоящие после слова <strong>else</strong>.
				</p>
				<p>
					Во втором блоке операторы в секции <strong>finally</strong>…<strong>end</strong> выполняются всегда
					независимо от того, было исключение или нет. Если исключение возникло
					внутри блока <strong>try</strong>…<strong>finally</strong>, то его выполнение прерывается и программа сразу
					переходит к первому оператору после слова <strong>finally</strong>. Обычно такой блок
					выбирается, если нужно освободить память из под динамических переменных,
					чтобы в случае сбоя в программе не произошла утечка памяти.
				</p>
				<p>
					Самый простой вариант обработки исключения выглядит следующим образом:
				</p>
				<code>
					<strong>Try</strong><br>
					...<br>
					<strong>except</strong><br>
					ShowMessage('Ошибка!!!');<br>
					<strong>End;</strong><br>
				</code>
				<p>
					При возникновении исключения по любой причине программа выдаст на экран
					сообщение об ошибке и не позволит программе аварийно завершиться.
				</p>
				<p>
					Если реагировать на разные исключительные ситуации нужно по разному, то
					обработчики исключений пишутся следующим образом:
				</p>
				<p>
					<strong>On</strong> &lt;класс исключения&gt; <strong>do</strong> &lt;оператор&gt;
				</p>
				<p>
					В качестве оператора может использоваться любой оператор кроме оператора
					перехода <strong>goto</strong>.
				</p>
				<p>
					Пример:
				</p>
				<code>
					<strong>Try</strong><br>
					Z:= X/Y;<br>
					<strong>Except</strong><br>
					Z:=1.1e+38; { максимальное вещественное число типа Double}<br>
					<strong>End;</strong>
				</code>
				<p>
					Имя класса служит своеобразным ключом выбора, а обработка исключения
					осуществляется оператором. Каждый класс исключений обрабатывает свой круг
					ошибок. Поиск нужного обработчика осуществляется сверху вниз до тех пор,
					пока не встретится оператор, способный обрабатывать исключение данного
					типа. Если таких операторов не найдется, управление перейдет к операторам,
					стоящим после <strong>else</strong>. Если и их нет, выполняется умалчиваемая обработка
					исключения. Программа выдаст сообщение с типом ошибки и приостановит
					выполнение.
				</p>
				<a name="1"></a>
				<h2>
					Стандартные классы исключений
				</h2>
				<p>
					Родоначальником всех классов исключений является класс <strong>Exception</strong>. В Delphi
					определено около 90 классов исключений. Рассмотрим некоторые:
				</p>
				<ol>
					<li>
						<strong>EconvertError</strong> - ошибка в преобразованиях <strong>strtoint</strong> и <strong>strtofloat</strong>.
						Возникает, когда вместо числа пользователь ввел буквы или вообще ничего не
						ввел.
					</li>
					<li>
						<strong>EdivByZero</strong> - ошибка целочисленного деления на ноль.
					</li>
					<li>
						<strong>EFOpenError</strong> - попытка открыть несуществующий файл.
					</li>
					<li>
						<strong>EinOutError</strong> - любая ошибка при работе с файлами.
					</li>
					<li>
						<strong>EintError</strong> - любая ошибка в целочисленных вычислениях.
					</li>
					<li>
						<strong>EmatchError</strong> - любая ошибка при вычислениях с вещественными числами
						(например, неправильно задано значение параметра стандартной математической
						функции).
					</li>
					<li>
						<strong>ErangeError</strong> - целочисленный результат превышает емкость целого типа
						данных.
					</li>
					<li>
						<strong>EzeroDivide</strong> - ошибка вещественного деления на ноль
					</li>
				</ol>
				<p>
					Классы <strong>EintError</strong> и <strong>EmatchError</strong> являются более общими, т.е. могут обработать
					любое исключение из области работы с целыми и вещественными числами
					соответственно. Поэтому, если нужно проверять разные ошибки в вычислениях,
					сначала записываются специализированные классы исключений, а затем общие.
				</p>
				<p>
					Пример:
				</p>
				<code>
					<strong>Try</strong><br>
					X:= (A +B) div C; {возможно деление на 0}<br>
					Y:= X * Z; {возможно переполнение}<br>
					<strong>Except</strong><br>
					<strong>On</strong> EdivByZero <strong>do</strong> ShowMessage ('Произошло деление на 0');<br>
					<strong>On</strong> ErangeError <strong>do</strong> ShowMessage ('Произошло переполнение');<br>
					<strong>On</strong> EintError <strong>do</strong> ShowMessage ('Ошибка в вычислениях');<br>
					<strong>End;</strong>
				</code>
				<p>
					Рассмотрим пример программы с использованием обработки исключений. Составим
					программу для вычисления корней квадратного уравнения. В ходе ее выполнения
					возможны следующие ошибки:
				</p>
				<ol>
					<li>
						Ошибка преобразования строки в число при неправильном вводе данных
						пользователем;
					</li>
					<li>
						Ошибка, которая возникнет при попытке получить корень из отрицательного
						дискриминанта;
					</li>
					<li>
						Деление на 0, если пользователь по ошибке введет а=0.
					</li>
				</ol>
				<p>Пример:</p>
				<code>
					
						<strong>Procedure</strong> Tform1.Button1Click(Sender: Tobject);<br>
						<strong>Var</strong><br>
						A,B,C,D,X1,X2:Double;<br>
						<strong>Begin</strong><br>
						<strong>Try</strong><br>
						A:=strtofloat(Edit1.Text);<br>
						B:=strtofloat(Edit2.Text);<br>
						C:=strtofloat(Edit3.Text);<br>
						<strong>Except</strong><br>
						<strong>On</strong> EconvertError <strong>do</strong> ShowMessage('Ошибка при вводе данных');<br>
						<strong>Exit;</strong> {программа прекращает обработку события OnClick}<br>
						<strong>End;</strong><br>
						D:=B*B-4*A*C;<br>
						<strong>try</strong><br>
						X1:=(-B+sqrt(D))/(2*A);<br>
						X2:=(-B-sqrt(D))/(2*A);<br>
						<strong>Except</strong><br>
						<strong>On</strong> EzeroDivide <strong>do</strong> ShowMessage(' Параметр а равен 0. Это неверно');<br>
						<strong>On</strong> EmatchError <strong>do</strong> ShowMessage('Дискриминант отрицателен. Решений нет');<br>
						<strong>End;</strong><br>
						Label1.Caption:='X1=' + floattostr(X1);<br>
						Label2.Caption:='X2=' + floattostr(X2);<br>
						<strong>End;</strong>
				</code>
			</article>	
		</main>
		<footer class="footer">
			<div></div>
		</footer>
		<script src="../../scripts.js"></script>
	</body>
</html>