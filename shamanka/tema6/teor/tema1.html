<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link href="../../style.css" rel="stylesheet">
	</head>
	<body>
		<header>
			<div>
				<a href="../../index.html"><h1>Учебный портал</h1></a>
			</div>
			<nav>
					<ul class="main_menu">
					<li>
						<a href="#"><p>Справочные материалы&#9207;</p></a>
						<ul class="submenu" id="sub1">
							<li><a href="../../delphi-lab-teor.html">Теория по Delphi</a></li>
						</ul>
					</li>
					<li>
						<a href="#"><p>Лабораторные работы&#9207;</p></a>
						<ul class="submenu" id="sub2">
							<li><a href="../../delphi-lab-prac.html">Задания по Delphi</a></li>
						</ul>
					</li>
				</ul>
			</nav>
		</header>
		<main>
			<div class="prev" style="opacity: 0.5;"><img src="../../res/prev.png"></div>
			<div class="next"><a href="tema2.html"><img src="../../res/next.png"></a></div>
			<aside id="sidebar">
				<h2>Быстрая навигация</h2>
				<ol>
					<li><a href="#1">Свойства компонента</a></li>
					<li><a href="#2">Методы компонента</a></li>
					<li><a href="#3">TPopupMenu</a></li>
				</ol>
			</aside>
			<article class="tema">
				<h2>
					TMainMenu - главное меню формы (программы)
				</h2>
				<p>
					Компонент класса TMainMenu определяет главное меню формы. На форму можно
					поместить сколько угодно объектов этого класса, но отображаться в полосе
					меню в верхней части формы будет только тот из них, который указан в
					свойстве Menu формы.
				</p>
				<p>
					После установки компонента на форму необходимо создать его опции. Для этого
					следует дважды щелкнуть по компоненту левой кнопкой мыши, либо нажать на
					нем правую кнопку[
					<em>
						Жаргонизмы “дважды щелкнуть по компоненту левой кнопкой мыши” и “нажать
						на нем правую кнопку” используются вполне сознательно в целях экономии
						вашего и моего времени. Разумеется, следовало бы писать что-нибудь
						вроде “в момент, когда указатель мыши находится над видимым
						изображением компонента, дважды подряд без заметной паузы нажать левую
						кнопку мыши” и “расположить указатель мыши так, чтобы острие указателя
						находилось в пределах видимого изображения компонента, и нажать правую
						кнопку мыши”. В дальнейшем я иногда буду прибегать к такого рода
						сокращениям, а посему -заранее приношу свои извинения, если они вам
						покажутся не очень литературными.
					</em>
					] и выбрать продолжение Menu Designer в появившемся вспомогательном меню,
					либо, наконец, щелкнуть по кнопке в правой половине строки items Инспектора
					объектов. Ниже показан вид окна конструктора меню, которое появится
					на экране после выполнения любого из перечисленных действий.
				</p>
				<p>
					<img
						width="328"
						height="276"
						src="tema1/image001.jpg"
					/>
				</p>
				<p>
					<em> Окно конструктора меню</em>
				</p>
				<p>
					Создание опций не вызывает проблем. Перейдите в окно Инспектора объектов и
					введите текст опции в строке caption, после чего нажмите Enter - опция
					готова, и можно переходить к следующей. Каждая опция главного меню может
					раскрываться в список подопций или содержать конечную команду. Для создания
					подопций щелкните мышью по строке ниже опции и введите первую подопцию.
					Продолжайте ввод, пока не будет создан весь список подопций, после чего
					щелкните по пустому прямоугольнику справа от первой опции и введите вторую
					опцию. Процесс гораздо сложнее описать, чем выполнить.
				</p>
				<p>
					В названиях опций можно указать символ “&amp;” перед тем символом, который
					определит клавишу быстрого выбора опции (в терминологии Windows такие
					клавиши называются акселераторами). Например, выше показана опция
					Файл, которую можно выбрать сочетанием клавиш Alt+Ф. При создании меню эта
					опция в строке caption Инспектора объектов содержала текст &amp;Файл.
				</p>
				<p>
					Если вы захотите вставить разделительную черту, отделяющую группы подопций,
					назовите очередной элемент меню именем “-”.
				</p>
				<p>
					Для создания разветвленных меню, т. е. таких, у которых подопций вызывают
					новые списки подопций, щелкните по подопций и нажмите Ctrl+вправо, где
					вправо - клавиша смещения курсора вправо. Такого же эффекта можно добиться
					после щелчка правой кнопкой мыши на подопций и выборе продолжения create
					Submenu.
				</p>
				<a name="1"></a>
				<p>
					Свойства компонента:
				</p>
				<table border="1" cellspacing="1" cellpadding="0" width="100%">
					<tbody>
						<tr>
							<td width="49%" valign="top">
								<p>
									property AutoMerge: Boolean;
								</p>
							</td>
							<td width="51%" valign="top">
								<p>
									Разрешает/запрещает слияние главного меню вторичной формы с
									главным меню основной формы в не MDI-приложениях
								</p>
							</td>
						</tr>
						<tr>
							<td width="49%" valign="top">
								<p>
									type TMenuItemAutoFlag = (maAutomatic, maManual, maPar-ent)
									; property AutoHotkeys: TMenuAuto-Flag;
								</p>
							</td>
							<td width="51%" valign="top">
								<p>
									Определяет, будет ли следить программа за уникальностью
									клавиш быстрого выбора для всех опций меню: maAutomatic -
									автоматически при создании опции; maManual -с помощью
									вызова специального метода; maparent - по правилу,
									установленному для опции верхнего уровня
								</p>
							</td>
						</tr>
						<tr>
							<td width="49%" valign="top">
								<p>
									property AutoLineReduction: TMenuItemAutoFlag;
								</p>
							</td>
							<td width="51%" valign="top">
								<p>
									Определяет, будет ли программа автомати чески удалять
									лишние разделители между опциями многоколончатого меню. Тип
									TMenuItemAutoFlag описан в свойстве AutoHotkeys
								</p>
							</td>
						</tr>
						<tr>
							<td width="49%" valign="top">
								<p>
									property Images: TCustomImageList;
								</p>
							</td>
							<td width="51%" valign="top">
								<p>
									Содержит ссылку на объект - хранилище изображении, которые
									могут появляться около индивидуальных элементов (пунктов) в
									меню
								</p>
							</td>
						</tr>
						<tr>
							<td width="49%" valign="top">
								<p>
									property Items: TMenuItem; default;
								</p>
							</td>
							<td width="51%" valign="top">
								<p>
									Открывает индексированный доступ к опциям меню
								</p>
							</td>
						</tr>
						<tr>
							<td width="49%" valign="top">
								<p>
									property OwnerDraw: Boolean;
								</p>
							</td>
							<td width="51%" valign="top">
								<p>
									Определяет, будет ли программа прорисовывать опции меню
									автоматически или с помощью обработчика onDrawltem
								</p>
							</td>
						</tr>
					</tbody>
				</table>
				<p>
					Если одна форма вызывает вторую форму в немодальном режиме, главное меню
					первой может сливаться с главным меню второй формы. Для этого свойство
					AutoMerge второй формы должно иметь значение True. Порядок слияния опций в
					этом случае устанавливается свойствами Groupindex опций второго меню. Чтобы
					продемонстрировать механизм слияния меню, проделайте следующее:
				</p>
				<p>
					· Начните новое приложение и на форму положите компонент TMainMenu.
				</p>
				<p>
					· Поместите в свойство Сaption единственной опции этого компонента значение
					открыть вторичное окно и напишите такой обработчик его события OnClick:
				</p>
				<p>
					<strong>procedure</strong>
					TFormI.NIClick(Sender: TObject);
				</p>
				<p>
					<strong>begin</strong>
				</p>
				<p>
					Form2.MainMenul.AutoMerge := True;
				</p>
				<p>
					Form2.Show
				</p>
				<p>
					<strong>end; </strong>
				</p>
				<p>
					· Присоедините к проекту вторую форму, щелкнув по инструментальной кнопке Н
					или с помощью опции File | New|
				</p>
				<p>
					Form.
				</p>
				<p>
					· Положите на эту форму TMainMenu, создайте в нем единственную опцию с
					Caption закрыть вторичное окно и таким обработчиком:
				</p>
				<p>
					<strong>procedure</strong>
					TForm2.NIClick(Sender: TObject);
				</p>
				<p>
					<strong>begin</strong>
				</p>
				<p>
					Close;
				</p>
				<p>
					Formi.MainMenul.Unmerge(MainMenul);
				</p>
				<p>
					<strong>end;</strong>
				</p>
				<p>
					Перед трансляцией свяжите модули окон предложениями Uses.
				</p>
				<p>
					Обратите внимание: если при закрытии вторичного окна не восстановить опции
					главного меню методом unmerge, эти опции останутся прежними (измененными).
				</p>
				<p>
					Свойство AutoMerge вторичного окна игнорируется, если оно вызывается в
					модальном режиме, а также если оно является дочерним окном MDI.
				</p>
				<a name="2"></a>
				<p>
					Наиболее важные методы компонента:
				</p>
				<table border="1" cellspacing="1" cellpadding="0" width="100%">
					<tbody>
						<tr>
							<td width="48%" valign="top">
								<p>
									function DispatchCommand (ACommand: Word): Boolean;
									dynamic;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Имитирует щелчок по опции, свойство которой command имеет
									значение ACommand. Если такой опции нет или она не является
									исполняемой, возвращает False
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									procedure Merge(Menu: TMainMenu);
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Объединяет пункты главного меню с пунктами меню Menu
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									procedure Unmerge(Menu: TMainMenu) ;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Удаляет из главного меню пункты меню Menu
								</p>
							</td>
						</tr>
					</tbody>
				</table>
				<p>
					Каждый элемент меню является объектом класса TMenuItem. Свойства этого
					класса описаны в следующей таблице. Термин “родительская опция” означает
					опцию, выбор которой приводит к раскрытию подменю с данной опцией.
				</p>
				<table border="1" cellspacing="1" cellpadding="0" width="100%">
					<tbody>
						<tr>
							<td width="48%" valign="top">
								<p>
									property AutoCheck: Boo
								</p>
								<p>
									lean;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Определяет, будет или нет автоматически изменяться свойство
									Сhecked при выборе опции меню
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									type TMenuItemAutoFlag =
								</p>
								<p>
									(maAutomatic, maManual, maParent);
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Определяет, будет ли следить программа за уникальностью
									клавиш быстрого выбора для подоп ций: maAutomatic -
									автоматически при создании
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property AutoHotkeys:
								</p>
								<p>
									TMenuItemAutoFlag;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									подопции; maManual - с помощью вызова специального метода;
									maParent - по правилу, установленному для опции верхнего
									уровня
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property AutoLineReduction:
								</p>
								<p>
									TMenuItemAutoFlag;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Определяет, будет ли программа автоматически удалять лишние
									разделители между опциями многоколончатого меню второго
									уровня. Тип TMenuItemAutoFlag описан в свойстве AutoHotkeys
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Bitmap: TBitmap;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Содержит ссылку на связанное с опцией изображение. Это
									изображение (если оно есть) появляется слева от опции.
									Свойство игнорируется, если установлено свойство Imagelndex
									(см. ниже)
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Break: TMenuBreak;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Позволяет создать многоколончатый список подменю (см.ниже)
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Checked: Boolean;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Если True, рядом с опцией появляется галочка
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Command: Word;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Используется при разработке приложений, обращающихся
									непосредственно к API-функциям Windows
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Count: Integer;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Содержит количество опций в подчиненном меню, связанном с
									данным элементом (только для чтения)
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Default: Boolean;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Определяет, является ли данная опция подменю умалчиваемой
									(см. ниже)
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Grouplndex: Byte;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Определяет групповой индекс для зависимых опций (см.
									свойство Radioltem)
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Imagelndex: Integer;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Содержит индекс связанного с опцией изображения из
									компонента TimageList. Это изображение
									(если оно есть) появляется слева от опции. Если свойство
									имеет значение -1, с опцией не связано никакого изображения
									из TimageList
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Items[Index: Integer] : TMenuItem;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Позволяет обратиться к любой опции подчиненного меню по ее
									индексу
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Menulndex: Integer;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Определяет индекс опции в списке items родительской опции
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Radio Itern: Boolean;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Определяет, зависит ли данная опция от выбора других опций
									в той же группе Grouplndex. Только одна опция группы может
									иметь True в свойстве checked. Рядом с такой опцией вместо
									галочки изображается круг
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property Shortcut: TshortCut;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Задает клавиши-акселераторы для быстрого выбора данной
									опции
								</p>
							</td>
						</tr>
						<tr>
							<td width="48%" valign="top">
								<p>
									property SubMenuImages:
								</p>
								<p>
									TCustomImageList;
								</p>
							</td>
							<td width="52%" valign="top">
								<p>
									Содержит ссылку на объект - хранилище изображений, которые
									могут появляться около индивидуальных элементов (пунктов) в
									подменю этого пункта меню
								</p>
							</td>
						</tr>
					</tbody>
				</table>
				<p>
					<img
						width="328"
						height="276"
						src="tema1/image002.jpg"
					/>
				</p>
				<p>
					<em> Разветвленная структура меню</em>
				</p>
				<p>
					В Delphi 4 (5 и 6) появилась возможность связывать с опциями меню небольшие
					изображения. Эти изображения можно задать либо свойством BitMap, либо
					свойством imageindex. В последнем случае предполагается, что для меню в
					целом определено свойство Images либо (только для версии 6) свойство
					SubMenuImages опции верхнего уровня. Изображение показывается слева от
					опции.
				</p>
				<p>
					<img
						width="108"
						height="143"
						src="tema1/image003.jpg"
					/>
				</p>
				<p>
					<em> Подменю File среды Delphi</em>
				</p>
				<p>
					Как видим, опции Open, open Ptoject, Save и т. д. снабжены небольшими
					пиктограммами. Введение пиктограмм в меню, с одной стороны, повышает
					наглядность меню, а с другой - способствует унификации пиктограмм в рамках
					механизма <em>действий</em>. Если опция меню связана с
					каким-то действием своим свойством Action, а компонент TActionList, в
					котором это действие описано, в свою очередь, связан с хранилищем
					пиктограмм TimageList, индекс нужной пиктограммы можно задать
					в свойстве ImageIndex. В этом случае пиктограмма, указанная в свойстве
					BitMap (если она указана в нем), игнорируется.
				</p>
				<p>
					Тип TMenuBreak определен следующим образом:
				</p>
				<p>
					<strong>type</strong>
					TMenuBreak = (mbNone, mbBarBreak, mbBreak);
				</p>
				<p>
					Свойство Break по умолчанию имеет значение mbNone. Два других возможных
					значения этого свойства используются для создания многоколончатых списков
					подменю. Значение mbBarBreak заканчивает предыдущую колонку
					и начинает новую. Эта опция меню будет открывать новую колонку, которая
					отделяется от предыдущей вертикальной чертой. Значение mbBreak также
					создает новую колонку, но не вставляет разделительную черту. Эти значения
					игнорируются в опциях самого первого уровня. В окне конструктора
					многоколончатое меню отображается как обычное.
				</p>
				<p>
					Если в опции Default установлено значение True, такая опция выделяется
					цветом и выбирается двойным щелчком мыши на родительской опции. Только одна опция в подменю может быть умалчиваемой.
				</p>
				<p>
					<img
						width="327"
						height="148"
						src="tema1/image004.jpg"
					/>
				</p>
				<p>
					<em> Пример многоколенчатого меню</em>
				</p>
				<p>
					В отличие от других видимых компонентов строка Hint для опций меню задает
					только расширенное сообщение, которое отображается на панели статуса.
				</p>
				<p>
					Для элемента меню определено единственное событие Onciick, которое
					возникает при щелчке на опции или при нажатии Enter, если в этот момент
					данная опция была выбрана (подсвечена). Обработчик события становится
					доступен после двойного щелчка на опции в окне конструктора меню.
				</p>
				<p>
					<a name="3"></a>
					<strong>TPopupMenu - вспомогательное (локальное) меню</strong>
				</p>
				<p>
					Компоненты класса TPopupMenu используются для создания вспомогательных
					(локальных) меню, появляющихся после нажатия правой кнопки мыши. В отличие
					от главного меню, вспомогательное меню может быть создано для любого
					оконного компонента. Чтобы связать щелчок правой кнопкой мыши на компоненте
					с раскрытием вспомогательного меню, в свойство PоPupmеnu компонента
					необходимо поместить имя компонента-меню.
				</p>
				<p>
					Вспомогательное меню создается с помощью конструктора меню и содержит
					элементы описанного в TMenuItem, поэтому процесс создания
					и свойства вспомогательного меню ничем не Отличаются ОТ TMainMenu.
				</p>
			</article>	
		</main>
		<footer class="footer">
			<div></div>
		</footer>
		<script src="../../scripts.js"></script>
	</body>
</html>