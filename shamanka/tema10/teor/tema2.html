<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link href="../../style.css" rel="stylesheet">
	</head>
	<body>
		<header>
			<div>
				<a href="../../index.html"><h1>Учебный портал</h1></a>
			</div>
			<nav>
					<ul class="main_menu">
					<li>
						<a href="#"><p>Справочные материалы&#9207;</p></a>
						<ul class="submenu" id="sub1">
							<li><a href="../../delphi-lab-teor.html">Теория по Delphi</a></li>
						</ul>
					</li>
					<li>
						<a href="#"><p>Лабораторные работы&#9207;</p></a>
						<ul class="submenu" id="sub2">
							<li><a href="../../delphi-lab-prac.html">Задания по Delphi</a></li>
						</ul>
					</li>
				</ul>
			</nav>
		</header>
		<main>
			<div class="prev"><a href="tema1.html"><img src="../../res/prev.png"></a></div>
			<div class="next"><a href="tema3.html"><img src="../../res/next.png"></a></div>
<!-- 			<aside id="sidebar">
				<h2>Быстрая навигация</h2>
				<ol>
					<li><a href="#1">Структура проекта</a></li>
					<li><a href="#2">Структура модуля</a></li>
					<li><a href="#3">Создание обработчиков события</a></li>
				</ol>
			</aside> -->
			<article class="tema">
				<h2>Динамический обмен данными</h2>
				<p>
					Аббревиатура DDEML обозначает Dynamic Data Exchange Management Library
					(библиотека управления динамическим обменом данными). DDEML это надстройка
					над сложной системой сообщений, называемой Dynamic Data Exchange (DDE).
					Библиотека, содержащая DDE била разработана для усиления возможностей
					первоначальной системы сообщений Windows.
				</p>
				<p>
					DDE дает возможность перейти через рамки приложения и взаимодействовать с
					другими приложениями и системами Windows.
				</p>
				<p>
					Dynamic Data Exchange получило свое имя потому, что позволяет двум
					приложениям обмениваться данными (текстовыми, через глобальную память)
					динамически во время выполнения. Связь между двумя программами можно
					установить таким образом, что изменения в одном приложении будут отражаться
					во втором. Например, если Вы меняете число в электронной таблице, то во
					втором приложении данные обновятся автоматически и отобразят изменения.
					Кроме того, с помощью DDE можно из своего приложения управлять другими
					приложениями такими, как Word for Windows, Report Smith, Excel и др.
				</p>
				<p>
					Надеюсь, что данное краткое вступление поможет понять что предмет
					обсуждения представляет интерес. Далее рассказывается, как использовать
					компоненты Delphi для построения DDE приложений.
				</p>
				<p>
					<strong>Использование DDE</strong>
				</p>
				<p>
					Приложение, получающее данные из другого приложения по DDE и/или
					управляющее другим приложением с помощью команд через DDE является
					DDE-клиентом. В этом случае второе приложение является DDE-сервером. Одно и
					то-же приложение может быть одновременно и сервером, и клиентом (например,
					MicroSoft Word).
				</p>
				<p>
					Основные понятия:
				</p>
				<p>
					Клиент – программа, инициирующая диалог.
				</p>
				<p>
					Сервер – программа, отвечающая на сообщения клиента.
				</p>
				<p>
					Топик (topic)– тема диалога.
				</p>
				<p>
					Элементы данных (items) – данные, передаваемые от одной программы к другой.
				</p>
				<p>
					Макрос (macros) – rкоманды, передаваемые в диалоге.
				</p>
				<p>
					В системе Delphi 7 для поддержки технологии DDE созданы 4 компонента,
					расположенные на панели System.
				</p>
				<table border="1" cellspacing="0" cellpadding="0">
					<tbody>
						<tr>
							<td width="215" valign="top">
								<p>
									Компонент
								</p>
							</td>
							<td width="445" valign="top">
								<p>
									Назначение
								</p>
							</td>
						</tr>
						<tr>
							<td width="215" valign="top">
								<p>
									TDdeClientConv
								</p>
							</td>
							<td width="445" valign="top">
								<p>
									Устанавливает связь с сервером DDE
								</p>
							</td>
						</tr>
						<tr>
							<td width="215" valign="top">
								<p>
									TDdeClientItem
								</p>
							</td>
							<td width="445" valign="top">
								<p>
									Конкретный объект, содержимое которого передаётся (или
									принимается) за один сеанс связи с сервером DDE.
									Обеспечивает транзакционную работу по обмену информацией
								</p>
							</td>
						</tr>
						<tr>
							<td width="215" valign="top">
								<p>
									TDdeServerConv
								</p>
							</td>
							<td width="445" valign="top">
								<p>
									Сервер DDE
								</p>
							</td>
						</tr>
						<tr>
							<td width="215" valign="top">
								<p>
									TDdeServerItem
								</p>
							</td>
							<td width="445" valign="top">
								<p>
									Объект строны сервера, содержимое которого предназначено
									для обмена
								</p>
							</td>
						</tr>
					</tbody>
				</table>
				<p>
					Компонент TddeClientConv обладает двумя важнейшими свойствами, лежащими в
					основе протокола DDE. Свойство DdeService описывает серверное приложение, с
					которым устанавливается связь, а свойство DDETopic характеризует имя
					серверного объекта, непосредственно участвующего в обмене информацией.
				</p>
				<p>
					Пример. Обмен сообщениями с MS Excel.
				</p>
				<p>
					Разместите на форме две кнопки – ПОСЛАТЬ и ПРИНЯТЬ, редактор Edit и
					компонент TddeClientConv.
				</p>
				<p>
					Запустите программу-сервер (в данном случае MS Excel), выберите
					произвольную ячейку, скопируйте её содержимое в буфер обмена Windows.
					Перейдите к Инспектору объектов и для любого из свойств DdeService/DdeTopic
					вызовите редактор связи с сервером DDE Info, щёлкнув по кнопке вызова в
					соответствующей строке Инспектора. Если программа, данные из которой были
					скопированы в буфер обмена, способна работать как сервер DDE, то кнопка
					PasteLink (установит связь) доступна. После щелчка по этой кнопке в
					соответствующие поля будут внесены имена сервера и объекта – первого листа
					таблицы. Теперь надо подтвердить связ щелчком по кнопке Ok.
				</p>
				<p>
					В процедурах – обработчиках событий нажатия кнопок наберите следующий код.
				</p>
				<p>
					PokeData – команда, посылающая сообщение. Первый параметр – принимающий
					объект (R1С1 – строка 1, столбец 1), второй параметр – передаваемая строка
					в формате Pchar.
				</p>
				<p>
					RequestData – фнукция, с помощью которой принимаются данные от объекта-
					сервера. Параметр – объект сервера, содержащий передаваемые данные,
					результат – строка в формате Pchar.
				</p>
				<br clear="all"/>
				<p>
					procedure TForm1.Button1Click(Sender: TObject);
				</p>
				<p>
					var ToExcel:array[0..100] of char;
				</p>
				<p>
					begin
				</p>
				<p>
					StrPCopy(ToExcel,Edit1.Text);
				</p>
				<p>
					DDEClientConv1.PokeData('R1C1',ToExcel);
				</p>
				<p>
					end;
				</p>
				<p>
					procedure TForm1.Button2Click(Sender: TObject);
				</p>
				<p>
					VAR FromEXCEL:PChar;
				</p>
				<p>
					begin
				</p>
				<p>
					FromExcel:=DDEClientConv1.RequestData('R7C2');
				</p>
				<p>
					Edit1.Text:=StrPas(FromEXCEL);
				</p>
				<p>
					end;
				</p>
			</article>	
		</main>
		<footer class="footer">
			<div></div>
		</footer>
		<script src="../../scripts.js"></script>
	</body>
</html>